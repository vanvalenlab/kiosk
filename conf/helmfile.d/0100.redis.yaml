helmDefaults:
  wait: true
  timeout: 600
  force: true

################################################################################
## Redis Data Store ############################################################
################################################################################

repositories:
  # Stable repo of official helm charts
  - name: bitnami
    url: https://charts.bitnami.com
releases:
  # Redis
  - name: redis
    labels:
      chart: redis
      component: database
    chart: bitnami/redis
    version: 10.5.13
    namespace: deepcell
    values:
      - resources:
          requests:
            cpu: 200m
            memory: 256Mi

        usePassword: false

        cluster:
          enabled: true
          slaveCount: 2

        sentinel:
          enabled: true

        sysctlImage:
          enabled: true
          mountHostSys: true
          command:
            - /bin/sh
            - -c
            - |-
              install_packages systemd
              sysctl -w net.core.somaxconn=10000
              echo never > /host-sys/kernel/mm/transparent_hugepage/enabled
